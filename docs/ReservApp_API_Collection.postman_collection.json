{
  "info": {
    "name": "ReservApp API - Complete Collection 2025",
    "description": "Colecci√≥n completa de la API de ReservApp con todos los endpoints actuales\n\nüåê **ReservApp** es una plataforma de gesti√≥n de reservas para hoteles, spas, restaurantes, tours y eventos con dashboard administrativo completo.\n\n## üîë Autenticaci√≥n\nLa mayor√≠a de endpoints requieren autenticaci√≥n JWT. Incluye el token en el header:\n```\nAuthorization: Bearer tu-jwt-token\n```\n\n## üåê Servidores\n- **Producci√≥n**: https://reservapp-web.vercel.app/api\n- **Desarrollo**: http://localhost:3000/api\n\n## üë§ Cuentas de Prueba\n- **Super Admin**: admin@reservapp.com (password: password123)\n- **Admin Hotel**: admin.salazar@reservapp.com (password: password123)\n- **Admin Restaurante**: admin.restaurant@reservapp.com (password: password123)\n- **Usuario Final**: juan.perez@gmail.com (password: password123)\n\n## üìö Documentaci√≥n\n- **API Docs**: https://reservapp-web.vercel.app/api/swagger\n- **Health Check**: https://reservapp-web.vercel.app/api/health",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "version": {
      "major": 3,
      "minor": 0,
      "patch": 0
    }
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:3000/api",
      "type": "string",
      "description": "Base URL para desarrollo local"
    },
    {
      "key": "prod_url",
      "value": "https://reservapp-web.vercel.app/api",
      "type": "string",
      "description": "Base URL para producci√≥n"
    },
    {
      "key": "jwt_token",
      "value": "",
      "type": "string",
      "description": "JWT token de autenticaci√≥n"
    },
    {
      "key": "user_id",
      "value": "",
      "type": "string",
      "description": "ID del usuario autenticado"
    },
    {
      "key": "venue_id",
      "value": "venue_123",
      "type": "string",
      "description": "ID de venue para testing"
    },
    {
      "key": "service_id",
      "value": "service_456",
      "type": "string",
      "description": "ID de servicio para testing"
    },
    {
      "key": "reservation_id",
      "value": "reservation_123",
      "type": "string",
      "description": "ID de reservaci√≥n para testing"
    }
  ],
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{jwt_token}}",
        "type": "string"
      }
    ]
  },
  "item": [
    {
      "name": "üîê Authentication",
      "item": [
        {
          "name": "Login Usuario",
          "event": [
            {
              "listen": "test",
              "script": {
                "type": "text/javascript",
                "exec": [
                  "// Guardar token autom√°ticamente para siguientes requests",
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    if (response.success && response.data && response.data.token) {",
                  "        pm.collectionVariables.set('jwt_token', response.data.token);",
                  "        pm.collectionVariables.set('user_id', response.data.user.id);",
                  "        console.log('‚úÖ Token guardado:', response.data.token.substring(0, 20) + '...');",
                  "        console.log('‚úÖ Usuario logueado:', response.data.user.email, '- Rol:', response.data.user.role);",
                  "    }",
                  "}",
                  "",
                  "pm.test('Login successful', function () {",
                  "    pm.expect(pm.response.code).to.equal(200);",
                  "    const response = pm.response.json();",
                  "    pm.expect(response.success).to.be.true;",
                  "    pm.expect(response.data.token).to.exist;",
                  "    pm.expect(response.data.user).to.exist;",
                  "});"
                ]
              }
            }
          ],
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"admin@reservapp.com\",\n  \"password\": \"password123\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/auth/login",
              "host": ["{{base_url}}"],
              "path": ["auth", "login"]
            },
            "description": "Autenticar usuario con email y contrase√±a. El JWT token se guarda autom√°ticamente para uso en otros endpoints."
          }
        },
        {
          "name": "Registro Usuario Final",
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"nuevo.usuario@ejemplo.com\",\n  \"password\": \"password123\",\n  \"confirmPassword\": \"password123\",\n  \"firstName\": \"Usuario\",\n  \"lastName\": \"Nuevo\",\n  \"phone\": \"+52 33 1234 5678\",\n  \"role\": \"USER\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/auth/register",
              "host": ["{{base_url}}"],
              "path": ["auth", "register"]
            },
            "description": "Registrar nuevo usuario final en la plataforma"
          }
        },
        {
          "name": "Obtener Perfil Usuario",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/auth/profile",
              "host": ["{{base_url}}"],
              "path": ["auth", "profile"]
            },
            "description": "Obtener informaci√≥n del perfil del usuario autenticado con JWT token"
          }
        },
        {
          "name": "Logout",
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/auth/logout",
              "host": ["{{base_url}}"],
              "path": ["auth", "logout"]
            },
            "description": "Cerrar sesi√≥n del usuario autenticado"
          }
        }
      ],
      "description": "Endpoints de autenticaci√≥n: login, registro, perfil y logout"
    },
    {
      "name": "üë• Users Management",
      "item": [
        {
          "name": "Listar Usuarios",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/users?role=USER&search=juan&page=1&limit=10",
              "host": ["{{base_url}}"],
              "path": ["users"],
              "query": [
                {
                  "key": "role",
                  "value": "USER",
                  "description": "Filtrar por rol: USER, ADMIN, SUPER_ADMIN, MANAGER"
                },
                {
                  "key": "search",
                  "value": "juan",
                  "description": "B√∫squeda por nombre o email"
                },
                {
                  "key": "isActive",
                  "value": "true",
                  "disabled": true,
                  "description": "Filtrar por usuarios activos"
                },
                {
                  "key": "page",
                  "value": "1",
                  "description": "N√∫mero de p√°gina"
                },
                {
                  "key": "limit",
                  "value": "10",
                  "description": "Elementos por p√°gina"
                }
              ]
            },
            "description": "Obtener lista de usuarios con filtros y paginaci√≥n (requiere permisos de administrador)"
          }
        },
        {
          "name": "Obtener Usuario por ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/users/{{user_id}}",
              "host": ["{{base_url}}"],
              "path": ["users", "{{user_id}}"]
            },
            "description": "Obtener detalles de un usuario espec√≠fico por ID"
          }
        },
        {
          "name": "Eliminar Usuario",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{base_url}}/users/{{user_id}}",
              "host": ["{{base_url}}"],
              "path": ["users", "{{user_id}}"]
            },
            "description": "Eliminar un usuario espec√≠fico (soft delete - marca como inactivo)"
          }
        }
      ],
      "description": "Gesti√≥n de usuarios del sistema"
    },
    {
      "name": "üè® Venues Management",
      "item": [
        {
          "name": "Listar Venues",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/venues?category=ACCOMMODATION&search=hotel&city=Guadalajara&page=1&limit=10",
              "host": ["{{base_url}}"],
              "path": ["venues"],
              "query": [
                {
                  "key": "category",
                  "value": "ACCOMMODATION",
                  "description": "ACCOMMODATION, SPA, RESTAURANT, TOURISM, EVENT_SPACE"
                },
                {
                  "key": "search",
                  "value": "hotel",
                  "description": "B√∫squeda por nombre o descripci√≥n"
                },
                {
                  "key": "city",
                  "value": "Guadalajara",
                  "description": "Filtrar por ciudad"
                },
                {
                  "key": "isActive",
                  "value": "true",
                  "disabled": true,
                  "description": "Solo venues activos"
                },
                {
                  "key": "rating",
                  "value": "4",
                  "disabled": true,
                  "description": "Rating m√≠nimo (1-5)"
                },
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "10"
                }
              ]
            },
            "description": "Obtener lista de venues con filtros avanzados"
          }
        },
        {
          "name": "Obtener Venue por ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/venues/{{venue_id}}",
              "host": ["{{base_url}}"],
              "path": ["venues", "{{venue_id}}"]
            },
            "description": "Obtener detalles completos de un venue espec√≠fico"
          }
        },
        {
          "name": "Crear Nuevo Venue",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Hotel Boutique Plaza\",\n  \"category\": \"ACCOMMODATION\",\n  \"description\": \"Hotel boutique en el centro hist√≥rico con servicio de primera clase\",\n  \"address\": \"Av. Hidalgo 123, Centro, Guadalajara, Jalisco\",\n  \"city\": \"Guadalajara\",\n  \"state\": \"Jalisco\",\n  \"country\": \"M√©xico\",\n  \"postalCode\": \"44100\",\n  \"latitude\": 20.6729,\n  \"longitude\": -103.3436,\n  \"phone\": \"+52 33 1234 5678\",\n  \"email\": \"contacto@hotelplaza.com\",\n  \"website\": \"https://hotelplaza.com\",\n  \"amenities\": [\"WiFi gratis\", \"Estacionamiento\", \"Aire acondicionado\", \"Room service\"],\n  \"images\": [\"https://ejemplo.com/hotel1.jpg\", \"https://ejemplo.com/hotel2.jpg\"],\n  \"priceRange\": {\n    \"min\": 1500,\n    \"max\": 4500,\n    \"currency\": \"MXN\"\n  },\n  \"policies\": {\n    \"checkIn\": \"15:00\",\n    \"checkOut\": \"11:00\",\n    \"cancellation\": \"Cancelaci√≥n gratuita hasta 24 horas antes\",\n    \"pets\": false,\n    \"smoking\": false\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/venues",
              "host": ["{{base_url}}"],
              "path": ["venues"]
            },
            "description": "Crear un nuevo venue en la plataforma (requiere rol ADMIN o SUPER_ADMIN)"
          }
        }
      ],
      "description": "Gesti√≥n de venues (hoteles, spas, restaurantes, etc.)"
    },
    {
      "name": "üõéÔ∏è Services Management",
      "item": [
        {
          "name": "Listar Servicios",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/services?venueId={{venue_id}}&category=ACCOMMODATION&isActive=true&page=1&limit=10",
              "host": ["{{base_url}}"],
              "path": ["services"],
              "query": [
                {
                  "key": "venueId",
                  "value": "{{venue_id}}",
                  "description": "ID del venue propietario"
                },
                {
                  "key": "category",
                  "value": "ACCOMMODATION",
                  "description": "Categor√≠a del servicio"
                },
                {
                  "key": "isActive",
                  "value": "true",
                  "description": "Solo servicios activos"
                },
                {
                  "key": "minPrice",
                  "value": "1000",
                  "disabled": true,
                  "description": "Precio m√≠nimo"
                },
                {
                  "key": "maxPrice",
                  "value": "5000",
                  "disabled": true,
                  "description": "Precio m√°ximo"
                },
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "10"
                }
              ]
            },
            "description": "Obtener lista de servicios disponibles con filtros"
          }
        },
        {
          "name": "Obtener Servicio por ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/services/{{service_id}}",
              "host": ["{{base_url}}"],
              "path": ["services", "{{service_id}}"]
            },
            "description": "Obtener detalles completos de un servicio espec√≠fico"
          }
        },
        {
          "name": "Crear Nuevo Servicio",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"venueId\": \"{{venue_id}}\",\n  \"name\": \"Suite Presidential\",\n  \"category\": \"ACCOMMODATION\",\n  \"description\": \"Suite de lujo con vista panor√°mica de la ciudad\",\n  \"duration\": 1440,\n  \"capacity\": 4,\n  \"price\": 4500.00,\n  \"currency\": \"MXN\",\n  \"features\": [\"Vista panor√°mica\", \"Jacuzzi privado\", \"Balc√≥n amplio\", \"Servicio de mayordomo\"],\n  \"images\": [\"https://ejemplo.com/suite1.jpg\", \"https://ejemplo.com/suite2.jpg\"],\n  \"isActive\": true,\n  \"cancellationPolicy\": \"Cancelaci√≥n gratuita hasta 48 horas antes\",\n  \"availableHours\": {\n    \"start\": \"15:00\",\n    \"end\": \"11:00\"\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/services",
              "host": ["{{base_url}}"],
              "path": ["services"]
            },
            "description": "Crear un nuevo servicio en un venue (requiere permisos de administrador del venue)"
          }
        }
      ],
      "description": "Gesti√≥n de servicios ofrecidos por los venues"
    },
    {
      "name": "üìÖ Reservations Management",
      "item": [
        {
          "name": "Listar Reservaciones",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/reservations?status=CONFIRMED&dateFrom=2024-01-01&dateTo=2024-12-31&page=1&limit=10",
              "host": ["{{base_url}}"],
              "path": ["reservations"],
              "query": [
                {
                  "key": "status",
                  "value": "CONFIRMED",
                  "description": "PENDING, CONFIRMED, CANCELLED, COMPLETED"
                },
                {
                  "key": "dateFrom",
                  "value": "2024-01-01",
                  "description": "Fecha inicio en formato YYYY-MM-DD"
                },
                {
                  "key": "dateTo",
                  "value": "2024-12-31",
                  "description": "Fecha fin en formato YYYY-MM-DD"
                },
                {
                  "key": "serviceId",
                  "value": "{{service_id}}",
                  "disabled": true,
                  "description": "Filtrar por servicio espec√≠fico"
                },
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "10"
                }
              ]
            },
            "description": "Obtener lista de reservaciones del usuario autenticado (usuarios ven sus reservas, admins ven todas)"
          }
        },
        {
          "name": "Obtener Reservaci√≥n por ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/reservations/{{reservation_id}}",
              "host": ["{{base_url}}"],
              "path": ["reservations", "{{reservation_id}}"]
            },
            "description": "Obtener detalles completos de una reservaci√≥n espec√≠fica"
          }
        },
        {
          "name": "Crear Nueva Reservaci√≥n",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"serviceId\": \"{{service_id}}\",\n  \"checkInDate\": \"2024-03-15\",\n  \"checkInTime\": \"15:00\",\n  \"checkOutDate\": \"2024-03-16\",\n  \"checkOutTime\": \"11:00\",\n  \"guests\": 2,\n  \"specialRequests\": \"Vista al jard√≠n preferible, cama king size\",\n  \"contactPhone\": \"+52 33 9876 5432\",\n  \"emergencyContact\": {\n    \"name\": \"Mar√≠a Gonz√°lez\",\n    \"phone\": \"+52 33 1111 2222\",\n    \"relationship\": \"Esposa\"\n  },\n  \"paymentInfo\": {\n    \"method\": \"STRIPE\",\n    \"paymentMethodId\": \"pm_card_visa_test\"\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/reservations",
              "host": ["{{base_url}}"],
              "path": ["reservations"]
            },
            "description": "Crear una nueva reservaci√≥n con pago autom√°tico integrado"
          }
        }
      ],
      "description": "Gesti√≥n completa de reservaciones"
    },
    {
      "name": "üìß Contact System",
      "item": [
        {
          "name": "Obtener Formularios de Contacto (Admin)",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/contact?status=PENDING&page=1&limit=10",
              "host": ["{{base_url}}"],
              "path": ["contact"],
              "query": [
                {
                  "key": "status",
                  "value": "PENDING",
                  "description": "PENDING, RESPONDED, RESOLVED"
                },
                {
                  "key": "page",
                  "value": "1",
                  "description": "N√∫mero de p√°gina"
                },
                {
                  "key": "limit",
                  "value": "10",
                  "description": "Elementos por p√°gina"
                }
              ]
            },
            "description": "Obtener lista de formularios de contacto para administradores"
          }
        },
        {
          "name": "Enviar Formulario de Contacto",
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"name\": \"Juan P√©rez\",\n  \"email\": \"juan.perez@ejemplo.com\",\n  \"phone\": \"+52 33 1234 5678\",\n  \"subject\": \"Consulta sobre reservaciones grupales\",\n  \"message\": \"Hola, me gustar√≠a obtener informaci√≥n sobre tarifas especiales para reservaciones grupales de 15 personas. ¬øManejan descuentos por volumen? Gracias.\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/contact",
              "host": ["{{base_url}}"],
              "path": ["contact"]
            },
            "description": "Enviar un formulario de contacto p√∫blico (no requiere autenticaci√≥n). Se env√≠an autom√°ticamente emails de notificaci√≥n."
          }
        },
        {
          "name": "Actualizar Estado Formulario",
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"id\": \"contact_form_123\",\n  \"status\": \"RESPONDED\",\n  \"notes\": \"Cliente contactado por tel√©fono, informaci√≥n enviada por email\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/contact",
              "host": ["{{base_url}}"],
              "path": ["contact"]
            },
            "description": "Actualizar el estado de un formulario de contacto (solo administradores)"
          }
        }
      ],
      "description": "Sistema de formularios de contacto con emails autom√°ticos"
    },
    {
      "name": "üõ†Ô∏è Admin Management",
      "item": [
        {
          "name": "Dashboard Estad√≠sticas",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/admin/stats",
              "host": ["{{base_url}}"],
              "path": ["admin", "stats"]
            },
            "description": "Obtener KPIs y estad√≠sticas del dashboard administrativo. SUPER_ADMIN ve todo, ADMIN ve solo sus venues."
          }
        },
        {
          "name": "Gesti√≥n de Pagos Admin",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/admin/payments?status=COMPLETED&dateFrom=2024-01-01&dateTo=2024-12-31&page=1&limit=20",
              "host": ["{{base_url}}"],
              "path": ["admin", "payments"],
              "query": [
                {
                  "key": "status",
                  "value": "COMPLETED",
                  "description": "PENDING, COMPLETED, FAILED, REFUNDED"
                },
                {
                  "key": "dateFrom",
                  "value": "2024-01-01",
                  "description": "Fecha inicio filtro"
                },
                {
                  "key": "dateTo",
                  "value": "2024-12-31",
                  "description": "Fecha fin filtro"
                },
                {
                  "key": "venueId",
                  "value": "{{venue_id}}",
                  "disabled": true,
                  "description": "Filtrar por venue espec√≠fico"
                },
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "20"
                }
              ]
            },
            "description": "Obtener lista de pagos para administradores con filtros avanzados"
          }
        },
        {
          "name": "Acciones de Pago Admin",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"action\": \"refund\",\n  \"paymentId\": \"payment_123\",\n  \"amount\": 2250.00,\n  \"reason\": \"Solicitud de reembolso por cancelaci√≥n del cliente\",\n  \"adminNotes\": \"Cliente cancel√≥ por enfermedad, se procede con reembolso completo seg√∫n pol√≠tica\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/admin/payments/actions",
              "host": ["{{base_url}}"],
              "path": ["admin", "payments", "actions"]
            },
            "description": "Ejecutar acciones administrativas sobre pagos: reembolsos, retries, etc."
          }
        },
        {
          "name": "Sistema de Logs - Listar",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/admin/system-logs?level=ERROR&level=WARN&category=API_REQUEST&dateFrom=2024-08-01&page=1&limit=50",
              "host": ["{{base_url}}"],
              "path": ["admin", "system-logs"],
              "query": [
                {
                  "key": "level",
                  "value": "ERROR",
                  "description": "DEBUG, INFO, WARN, ERROR"
                },
                {
                  "key": "level",
                  "value": "WARN",
                  "description": "Se pueden agregar m√∫ltiples levels"
                },
                {
                  "key": "category",
                  "value": "API_REQUEST",
                  "description": "API_REQUEST, AUTHENTICATION, PAYMENT, DATABASE, SYSTEM"
                },
                {
                  "key": "eventType",
                  "value": "payment_failed",
                  "disabled": true,
                  "description": "Tipo espec√≠fico de evento"
                },
                {
                  "key": "userId",
                  "value": "{{user_id}}",
                  "disabled": true,
                  "description": "Filtrar por usuario espec√≠fico"
                },
                {
                  "key": "dateFrom",
                  "value": "2024-08-01",
                  "description": "Fecha inicio en formato YYYY-MM-DD"
                },
                {
                  "key": "dateTo",
                  "value": "2024-08-31",
                  "disabled": true,
                  "description": "Fecha fin en formato YYYY-MM-DD"
                },
                {
                  "key": "search",
                  "value": "error 500",
                  "disabled": true,
                  "description": "B√∫squeda de texto libre"
                },
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "50"
                }
              ]
            },
            "description": "Obtener logs del sistema con filtros avanzados (solo SUPER_ADMIN)"
          }
        },
        {
          "name": "Sistema de Logs - Estad√≠sticas",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/admin/system-logs/stats?dateFrom=2024-08-01&dateTo=2024-08-31",
              "host": ["{{base_url}}"],
              "path": ["admin", "system-logs", "stats"],
              "query": [
                {
                  "key": "dateFrom",
                  "value": "2024-08-01",
                  "description": "Fecha inicio para estad√≠sticas"
                },
                {
                  "key": "dateTo",
                  "value": "2024-08-31",
                  "description": "Fecha fin para estad√≠sticas"
                }
              ]
            },
            "description": "Obtener estad√≠sticas agregadas de logs del sistema"
          }
        },
        {
          "name": "Sistema de Logs - Limpiar",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"olderThanDays\": 30,\n  \"levels\": [\"DEBUG\", \"INFO\"],\n  \"confirm\": true\n}"
            },
            "url": {
              "raw": "{{base_url}}/admin/system-logs/cleanup",
              "host": ["{{base_url}}"],
              "path": ["admin", "system-logs", "cleanup"]
            },
            "description": "Limpiar logs antiguos del sistema seg√∫n criterios especificados"
          }
        },
        {
          "name": "Sistema de Logs - Exportar",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/admin/system-logs/export?format=csv&level=ERROR&dateFrom=2024-08-01&dateTo=2024-08-31",
              "host": ["{{base_url}}"],
              "path": ["admin", "system-logs", "export"],
              "query": [
                {
                  "key": "format",
                  "value": "csv",
                  "description": "Formato: csv, json"
                },
                {
                  "key": "level",
                  "value": "ERROR",
                  "description": "Filtrar por nivel de log"
                },
                {
                  "key": "dateFrom",
                  "value": "2024-08-01",
                  "description": "Fecha inicio"
                },
                {
                  "key": "dateTo",
                  "value": "2024-08-31",
                  "description": "Fecha fin"
                }
              ]
            },
            "description": "Exportar logs del sistema en formato CSV o JSON"
          }
        }
      ],
      "description": "Endpoints administrativos avanzados: estad√≠sticas, pagos, logs del sistema"
    },
    {
      "name": "üí≥ Payments & Subscription",
      "item": [
        {
          "name": "Crear Suscripci√≥n Premium",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"priceId\": \"price_premium_monthly\",\n  \"paymentMethodId\": \"pm_card_visa_test\",\n  \"businessInfo\": {\n    \"businessName\": \"Hotel Boutique Plaza\",\n    \"businessType\": \"ACCOMMODATION\",\n    \"taxId\": \"RFC123456789\",\n    \"address\": {\n      \"street\": \"Av. Hidalgo 123\",\n      \"city\": \"Guadalajara\",\n      \"state\": \"Jalisco\",\n      \"postalCode\": \"44100\",\n      \"country\": \"M√©xico\"\n    }\n  }\n}"
            },
            "url": {
              "raw": "{{base_url}}/payments/subscription",
              "host": ["{{base_url}}"],
              "path": ["payments", "subscription"]
            },
            "description": "Crear suscripci√≥n premium para usuarios business con Stripe"
          }
        }
      ],
      "description": "Sistema de pagos y suscripciones con Stripe"
    },
    {
      "name": "üîî Notifications",
      "item": [
        {
          "name": "Listar Notificaciones",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/notifications?unread=false&type=BOOKING_CONFIRMED&page=1&limit=20",
              "host": ["{{base_url}}"],
              "path": ["notifications"],
              "query": [
                {
                  "key": "unread",
                  "value": "false",
                  "description": "true para solo no le√≠das, false para todas"
                },
                {
                  "key": "type",
                  "value": "BOOKING_CONFIRMED",
                  "description": "Tipo espec√≠fico de notificaci√≥n"
                },
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "20"
                }
              ]
            },
            "description": "Obtener notificaciones del usuario autenticado con filtros"
          }
        }
      ],
      "description": "Sistema de notificaciones en tiempo real"
    },
    {
      "name": "‚öôÔ∏è System Health & Utils",
      "item": [
        {
          "name": "Health Check",
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/health",
              "host": ["{{base_url}}"],
              "path": ["health"]
            },
            "description": "Verificar estado de la API y servicios conectados (base de datos, Stripe, Resend, etc.)"
          }
        },
        {
          "name": "API Documentation (Swagger)",
          "request": {
            "auth": {
              "type": "noauth"
            },
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/swagger",
              "host": ["{{base_url}}"],
              "path": ["swagger"]
            },
            "description": "Obtener documentaci√≥n completa de la API en formato OpenAPI/Swagger"
          }
        }
      ],
      "description": "Herramientas de monitoreo y documentaci√≥n del sistema"
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Auto-configurar base URL seg√∫n el entorno",
          "const currentUrl = pm.request.url.host.join('.');",
          "if (currentUrl.includes('localhost')) {",
          "    pm.collectionVariables.set('base_url', 'http://localhost:3000/api');",
          "    console.log('üè† Ambiente: Desarrollo Local');",
          "} else if (currentUrl.includes('vercel.app')) {",
          "    pm.collectionVariables.set('base_url', 'https://reservapp-web.vercel.app/api');",
          "    console.log('üåê Ambiente: Producci√≥n Vercel');",
          "}",
          "",
          "// Auto-configurar variables de test si no existen",
          "if (!pm.collectionVariables.get('venue_id')) {",
          "    pm.collectionVariables.set('venue_id', 'venue_test_123');",
          "}",
          "if (!pm.collectionVariables.get('service_id')) {",
          "    pm.collectionVariables.set('service_id', 'service_test_456');",
          "}",
          "if (!pm.collectionVariables.get('reservation_id')) {",
          "    pm.collectionVariables.set('reservation_id', 'reservation_test_789');",
          "}",
          "",
          "// Log de estado de autenticaci√≥n",
          "const token = pm.collectionVariables.get('jwt_token');",
          "if (token) {",
          "    console.log('üîë Token JWT: Presente ‚úÖ');",
          "    // Extraer informaci√≥n del token (solo para logging, no para seguridad)",
          "    try {",
          "        const tokenPayload = JSON.parse(atob(token.split('.')[1]));",
          "        console.log('üë§ Usuario logueado:', tokenPayload.email || 'N/A');",
          "        console.log('üîê Rol:', tokenPayload.role || 'N/A');",
          "        const exp = new Date(tokenPayload.exp * 1000);",
          "        console.log('‚è∞ Token expira:', exp.toLocaleString());",
          "    } catch (e) {",
          "        console.log('‚ö†Ô∏è No se pudo decodificar token payload');",
          "    }",
          "} else {",
          "    console.log('üîë Token JWT: No presente ‚ùå');",
          "    console.log('üí° Ejecuta \"Login Usuario\" para autenticarte');",
          "}",
          "",
          "console.log('üåê Base URL actual:', pm.collectionVariables.get('base_url'));"
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Tests globales aplicables a todas las respuestas",
          "",
          "// Test de tiempo de respuesta",
          "pm.test('‚ö° Response time is acceptable (<3s)', function () {",
          "    pm.expect(pm.response.responseTime).to.be.below(3000);",
          "});",
          "",
          "// Test de contenido JSON",
          "pm.test('üìã Response has JSON content-type', function () {",
          "    const contentType = pm.response.headers.get('Content-Type');",
          "    pm.expect(contentType).to.include('application/json');",
          "});",
          "",
          "// Tests espec√≠ficos para respuestas exitosas",
          "if (pm.response.code >= 200 && pm.response.code < 300) {",
          "    pm.test('‚úÖ Success response format is correct', function () {",
          "        const response = pm.response.json();",
          "        pm.expect(response).to.have.property('success', true);",
          "        pm.expect(response).to.have.property('message');",
          "        // timestamp es opcional pero si existe debe ser string",
          "        if (response.timestamp) {",
          "            pm.expect(response.timestamp).to.be.a('string');",
          "        }",
          "    });",
          "",
          "    // Auto-captura de IDs importantes para siguientes requests",
          "    const response = pm.response.json();",
          "    if (response.data) {",
          "        // Capturar IDs de recursos creados",
          "        if (response.data.id) {",
          "            const endpoint = pm.request.url.getPath().join('/');",
          "            if (endpoint.includes('venues') && pm.request.method === 'POST') {",
          "                pm.collectionVariables.set('venue_id', response.data.id);",
          "                console.log('üè® Venue ID capturado:', response.data.id);",
          "            } else if (endpoint.includes('services') && pm.request.method === 'POST') {",
          "                pm.collectionVariables.set('service_id', response.data.id);",
          "                console.log('üõéÔ∏è Service ID capturado:', response.data.id);",
          "            } else if (endpoint.includes('reservations') && pm.request.method === 'POST') {",
          "                pm.collectionVariables.set('reservation_id', response.data.id);",
          "                console.log('üìÖ Reservation ID capturado:', response.data.id);",
          "            }",
          "        }",
          "",
          "        // Capturar informaci√≥n de autenticaci√≥n",
          "        if (response.data.token) {",
          "            console.log('üîë Nuevo token JWT disponible');",
          "        }",
          "        if (response.data.user) {",
          "            console.log('üë§ Informaci√≥n de usuario disponible:', response.data.user.email);",
          "        }",
          "",
          "        // Log de datos importantes para debugging",
          "        if (response.data.paymentIntent) {",
          "            console.log('üí≥ Payment Intent creado:', response.data.paymentIntent.id);",
          "        }",
          "        if (response.data.subscription) {",
          "            console.log('üìã Suscripci√≥n creada:', response.data.subscription.id);",
          "        }",
          "    }",
          "}",
          "",
          "// Tests espec√≠ficos para respuestas de error",
          "if (pm.response.code >= 400) {",
          "    pm.test('‚ùå Error response format is correct', function () {",
          "        const response = pm.response.json();",
          "        pm.expect(response).to.have.property('success', false);",
          "        pm.expect(response).to.have.property('message');",
          "        // error es opcional pero si existe debe ser string",
          "        if (response.error) {",
          "            pm.expect(response.error).to.be.a('string');",
          "        }",
          "    });",
          "",
          "    // Log detallado de errores para debugging",
          "    const errorResponse = pm.response.json();",
          "    console.error('‚ùå Error details:', {",
          "        status: pm.response.code,",
          "        message: errorResponse.message,",
          "        error: errorResponse.error,",
          "        endpoint: pm.request.url.toString()",
          "    });",
          "}",
          "",
          "// Tests de status codes espec√≠ficos",
          "if (pm.response.code === 401) {",
          "    console.log('üîê Unauthorized - Verifica tu token JWT');",
          "} else if (pm.response.code === 403) {",
          "    console.log('üö´ Forbidden - Permisos insuficientes para este endpoint');",
          "} else if (pm.response.code === 429) {",
          "    console.log('‚è≥ Rate Limited - Demasiadas requests, espera un momento');",
          "}",
          "",
          "// Log del resultado general",
          "const statusEmoji = pm.response.code < 300 ? '‚úÖ' : pm.response.code < 500 ? '‚ö†Ô∏è' : '‚ùå';",
          "console.log(`${statusEmoji} Request completed: ${pm.response.code} ${pm.response.status} in ${pm.response.responseTime}ms`);"
        ]
      }
    }
  ]
}